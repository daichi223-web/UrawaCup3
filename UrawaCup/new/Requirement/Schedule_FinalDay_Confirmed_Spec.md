# 日程表示 & 最終日組み合わせ 確定仕様

---

## 1. 日程表示（予選リーグ）

### 1.1 形式

**日付タブ + 4会場横並び（案A）**

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  日程表                                                         [保存]     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  [3/29(土)] [3/30(日)] [3/31(月)]                  ← 日付タブ              │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐
│  │   浦和南高G     │ │  市立浦和高G    │ │  浦和学院高G    │ │    武南高G    │
│  │   (グループA)   │ │   (グループB)   │ │   (グループC)   │ │  (グループD)  │
│  ├─────────────────┤ ├─────────────────┤ ├─────────────────┤ ├───────────────┤
│  │KO   対戦     審判│ │KO   対戦     審判│ │KO   対戦     審判│ │KO   対戦   審判│
│  ├─────────────────┤ ├─────────────────┤ ├─────────────────┤ ├───────────────┤
│  │9:00 浦和南      │ │9:00 市立浦和    │ │9:00 浦和学院    │ │9:00 武南     │
│  │     vs 専大北上 │ │     vs 野辺地西 │ │     vs 日大明誠 │ │     vs 聖和学園│
│  ├─────────────────┤ ├─────────────────┤ ├─────────────────┤ ├───────────────┤
│  │10:05 東海大相模 │ │10:05 敬愛学園   │ │10:05 旭川実業   │ │10:05 國學院  │
│  │      vs 健大高崎│ │      vs 日本文理│ │      vs 富士市立│ │      vs 韮崎  │
│  ├─────────────────┤ ├─────────────────┤ ├─────────────────┤ ├───────────────┤
│  │11:10 ...        │ │11:10 ...        │ │11:10 ...        │ │11:10 ...     │
│  │                 │ │                 │ │                 │ │              │
│  └─────────────────┘ └─────────────────┘ └─────────────────┘ └───────────────┘
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 編集可能な項目

| 項目 | 編集方法 |
|------|----------|
| キックオフ時間 | ドロップダウン |
| 対戦チーム（ホーム） | ドロップダウン / クリック入れ替え |
| 対戦チーム（アウェイ） | ドロップダウン / クリック入れ替え |
| 審判 | ドロップダウン |

### 1.3 会場カード詳細

```
┌─────────────────────────────────────────────────────────────────┐
│  浦和南高G（グループA）                              [＋試合追加] │
├──────┬─────────────────────────────┬────────────────┬──────────┤
│  KO  │          対 戦              │     審 判      │          │
├──────┼─────────────────────────────┼────────────────┼──────────┤
│[9:00▼]│ [浦和南 ▼]   -  [専大北上▼] │ [当該▼]       │  [🗑️]   │
│      │                             │                │          │
├──────┼─────────────────────────────┼────────────────┼──────────┤
│[10:05▼]│[東海大相模▼] - [健大高崎▼]│ [当該▼]       │  [🗑️]   │
│      │                             │                │          │
├──────┼─────────────────────────────┼────────────────┼──────────┤
│[11:10▼]│ [浦和南 ▼]  - [東海大相模▼]│ [当該▼]       │  [🗑️]   │
│      │                             │                │          │
├──────┴─────────────────────────────┴────────────────┴──────────┤
│                                     [入れ替え]  ← 入れ替えモード │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 最終日組み合わせ

### 2.1 画面構成

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  最終日組み合わせ                              [自動生成] [入れ替え] [保存] │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  3月31日（日）【順位リーグ】                                                │
│                                                                             │
│  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐
│  │   浦和南高G     │ │  市立浦和高G    │ │  浦和学院高G    │ │    武南高G    │
│  │                 │ │                 │ │                 │ │               │
│  │  (会場カード)   │ │  (会場カード)   │ │  (会場カード)   │ │  (会場カード) │
│  │                 │ │                 │ │                 │ │               │
│  └─────────────────┘ └─────────────────┘ └─────────────────┘ └───────────────┘
│                                                                             │
│  3月31日（日）【3決・決勝戦】                                               │
│                                                                             │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │                        駒場スタジアム                                  │ │
│  │                                                                        │ │
│  │  (決勝トーナメント)                                                    │ │
│  │                                                                        │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 チーム選択方法

#### 方法1: ドロップダウンで直接選択

```
  ┌────────────┐     ┌────────────┐
  │ 4位③  ▼  │  -  │ 5位①  ▼  │
  └────────────┘     └────────────┘
       │
       ▼ クリック
  ┌─────────────────┐
  │ 【シード】      │
  │  A1位 (浦和南)  │
  │  A2位 (市立浦和)│
  │  ...            │
  │  4位③ ✓        │ ← 現在選択中
  │  5位①          │
  │ ──────────────  │
  │ 【全チーム】    │
  │  浦和南         │
  │  市立浦和       │
  │  ...            │
  └─────────────────┘
```

#### 方法2: 入れ替えボタンで2チーム選択

```
Step 1: [入れ替え] ボタンをクリック
        → 入れ替えモードON
        → 「1つ目のチームを選択してください」

Step 2: 1つ目のチームをクリック
  ┌────────────┐
  │▶ 4位③    │   ← 青枠で選択状態
  └────────────┘
        → 「2つ目のチームを選択してください」

Step 3: 2つ目のチームをクリック
  ┌────────────┐
  │  明秀日立  │   ← クリックすると入れ替え実行
  └────────────┘

Step 4: 入れ替え完了
  ┌────────────┐           ┌────────────┐
  │ 明秀日立   │  ←交換→  │ 4位③     │
  └────────────┘           └────────────┘
        → 「入れ替えました」（トースト通知）
        → 入れ替えモードOFF（続けるには再度ボタン）
```

### 2.3 入れ替えモードのUI

```
【通常モード】

  ヘッダー: [自動生成] [入れ替え] [保存]
                        ↑ 通常ボタン

  チーム枠: ドロップダウン形式
  ┌────────────┐
  │ 4位③  ▼  │
  └────────────┘


【入れ替えモード ON】

  ヘッダー: [自動生成] [入れ替え中...] [キャンセル] [保存]
                        ↑ 青色で強調 + スピナー？

  メッセージ: 「1つ目のチームを選択してください」

  チーム枠: クリック可能な状態
  ┌────────────┐
  │ 4位③     │  ← ▼ 消える、ホバーで青枠
  └────────────┘


【1つ目選択済み】

  メッセージ: 「2つ目のチームを選択してください（4位③ と入れ替え）」

  チーム枠:
  ┌────────────┐
  │▶ 4位③    │  ← 選択中（青枠 + チェックアイコン）
  └────────────┘

  ┌────────────┐
  │ 明秀日立   │  ← ホバーで緑枠（入れ替え可能）
  └────────────┘

  ┌────────────┐
  │🔒SF1勝者  │  ← グレーアウト（入れ替え不可）
  └────────────┘
```

### 2.4 入れ替えのキャンセル

```
方法:
- [キャンセル] ボタンをクリック
- ESCキーを押す
- 選択中のチームをもう一度クリック

→ 入れ替えモードOFF、選択解除
```

---

## 3. 共通仕様

### 3.1 会場カードの構造

```
┌─────────────────────────────────────────────────────────────────┐
│  会場名                                          [＋試合追加]   │
├──────┬─────────────────────────────┬────────────────┬──────────┤
│  KO  │          対 戦              │     審 判      │          │
├──────┼─────────────────────────────┼────────────────┼──────────┤
│[時間▼]│ [ホーム▼]   -   [アウェイ▼] │ [審判▼]       │  [🗑️]   │
├──────┼─────────────────────────────┼────────────────┼──────────┤
│      │     ...（試合行が続く）      │                │          │
├──────┴─────────────────────────────┴────────────────┴──────────┤
│  会場担当: [チーム名 ▼]                                         │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 ドロップダウンの選択肢

#### キックオフ時間
```
9:00, 9:30, 10:00, 10:05, 10:35, 11:00, 11:10, 11:40,
12:00, 12:45, 13:00, 13:05, 13:50, カスタム入力...
```

#### チーム（予選リーグ）
```
【グループA】
  浦和南, 専大北上, 東海大相模, 健大高崎
【グループB】
  市立浦和, 野辺地西, 敬愛学園, 日本文理
...
```

#### チーム（最終日）
```
【シード】
  A1位 (チーム名), A2位 (チーム名), ...
  4位① (チーム名), 4位② (チーム名), ...
【全チーム】
  全チーム検索可能リスト
```

#### 審判
```
派遣, 当該, ──────, 浦和南, 市立浦和, ...（全チーム）
```

---

## 4. 画面遷移

```
┌─────────────────────────────────────────────────────────────────┐
│                          サイドメニュー                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  📅 日程表        ← 予選リーグの日程（編集可能）               │
│                                                                 │
│  🏆 最終日組み合わせ ← 順位リーグ＋決勝T（編集可能）           │
│                                                                 │
│  📝 結果入力      ← 試合結果の入力                              │
│                                                                 │
│  📊 順位表        ← グループ別順位                              │
│                                                                 │
│  📄 報告書出力    ← PDF出力                                     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. データ構造

### 5.1 予選試合（Match）

```typescript
interface Match {
  id: number;
  tournamentId: number;
  venueId: number;
  matchDate: string;           // "2025-03-29"
  kickoffTime: string;         // "9:00"
  groupId: string;             // "A", "B", "C", "D"
  homeTeamId: number;
  awayTeamId: number;
  referee: string;             // "当該", "派遣", チーム名
  displayOrder: number;
  
  // 結果
  homeScore: number | null;
  awayScore: number | null;
  status: 'scheduled' | 'completed';
}
```

### 5.2 最終日試合（FinalDayMatch）

```typescript
interface FinalDayMatch {
  id: string;
  tournamentId: number;
  venueId: number;
  kickoffTime: string;
  matchType: 'training' | 'semifinal1' | 'semifinal2' | 'third_place' | 'final';
  displayOrder: number;
  
  // チーム
  homeTeamId: number | null;
  awayTeamId: number | null;
  homeSeed: string | null;     // "A1", "4位③", "SF1勝者"
  awaySeed: string | null;
  
  // 審判
  refereeMain: string;
  refereeAssistant: string;
  
  // 結果
  homeScore: number | null;
  awayScore: number | null;
  status: 'scheduled' | 'completed';
}
```

---

## 6. 実装チェックリスト

### 日程表（予選）
- [ ] 日付タブ切り替え
- [ ] 4会場横並び表示
- [ ] キックオフ時間ドロップダウン
- [ ] チームドロップダウン
- [ ] 審判ドロップダウン
- [ ] 試合追加
- [ ] 試合削除
- [ ] 入れ替えボタン + 2クリック入れ替え
- [ ] 保存

### 最終日組み合わせ
- [ ] 自動生成
- [ ] 4会場横並び表示（順位リーグ）
- [ ] 駒場スタジアム表示（決勝T）
- [ ] キックオフ時間ドロップダウン
- [ ] チームドロップダウン
- [ ] 審判ドロップダウン
- [ ] 会場担当ドロップダウン
- [ ] 試合追加
- [ ] 試合削除（3決・決勝以外）
- [ ] 入れ替えボタン + 2クリック入れ替え
- [ ] 入れ替えキャンセル
- [ ] 保存
